{% extends '::layout.html.twig' %}

{% block body %}
    <ol class="breadcrumb">
      <li class="active">{% trans %} lock.list_incidences {% endtrans %}</li>
    </ol>

<legend>{% trans %} lock.list_incidences {% endtrans %}
        {% if id_socio != 'none' %} {% trans %} workshop {% endtrans %} <a>#{{ id_socio }},{{ id_taller }}{% endif %}</a></legend>

   {#  {% if is_granted('ROLE_SUPER_ADMIN') %}
    <div class="col-xs-3 col-md-3 form-group"> <label> {% trans %} country {% endtrans %} </label>
        <select id="flt_country" class='form-control'>
                <option value="none">{% trans %} all {% endtrans %}</option>
            {% for country in countries %}
                <option value="{{ country }}">{{ country }}</option>
            {% endfor %}
    </select></div>
    {% endif %} #}

    {% if is_granted('ROLE_ASSESSOR') %}
        <div class="col-xs-6 col-md-6 form-group">
            <div class="col-xs-2 col-md-2"><label> {% trans %} code {% endtrans %} </label></div>
            <div class="col-xs-3 col-md-3"><input type="text"   id="flt_socio"  class='form-control' placeholder="{% trans %} partner  {% endtrans %}"></div>
            <div class="col-xs-3 col-md-3"><input type="text"   id="flt_taller" class='form-control' placeholder="{% trans %} workshop {% endtrans %}"
                                                  data-partner="{% trans %} code.partner {% endtrans %}"
                                                  data-num="{% trans %} code.numeric {% endtrans %}"
                                                  data-url="{{ path('list_incidences', { 'page': 'plc_page', 'id_taller' : 'plc_taller', 'id_socio' : 'plc_socio' }) }}"></div>
            <div class="col-xs-3 col-md-3"><input type="submit" id="btn_search" class="btn btn-primary"  value="{% trans %} btn.search {% endtrans %}"></div>
        </div>

        <script>
            $(document).ready(function() {
                $( "#flt_socio" ).focus();
                {% if id_socio  != 'none' %} $("#flt_socio" ).val('{{ id_socio }}' );{% endif %}
                {% if id_taller != 'none' %} $("#flt_taller").val('{{ id_taller }}');{% endif %}
                //util.js
                table_filter();
            });
        </script>

    {% endif %}

    {% if incidences|length > 0  %}
    <table class="table table-hover table-list-search" style="width: 90%; margin-left: 5%;">
        <thead>
            <tr>
                <th>#</th>
                <th>{% trans %} date        {% endtrans %}</th>
                <th>{% trans %} system      {% endtrans %}</th>
                <th>{% trans %} car         {% endtrans %}</th>
                <th>{% trans %} assigned_to {% endtrans %}</th>
            </tr>
        </thead>
        <tbody>
                {% for incidence in incidences %}
            <tr class="incidenceRow" data-url="{{ path('show_incidence', {'id_incidence': 'PLACEHOLDER'}) }}">
                <td id="id_incidence">{{ incidence.id }}</td>
                <td>{{ incidence.date   }}</td> {# | date("d/m/Y") #}
                <td>{{ incidence.oper   }}</td>
                <td>{{ incidence.coche  }}</td>
                <td>{{ incidence.asesor }}</td>
            </tr>
                {% endfor %}
        </tbody>
    </table>

    {% include 'UtilBundle:Pagination:pagination_incidence.html.twig' %}

    {% else %}
        {% trans %} any.incidence {% endtrans %}
    {% endif %}

{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('bundles/util/js/util.js') }}"></script>
    <script src="{{ asset('bundles/lock/js/incidence.js') }}"></script>
    <script src="{{ asset('bundles/util/js/pagination_incidence.js') }}"></script>

{% endblock %}