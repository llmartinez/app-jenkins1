{% extends '::layout.html.twig' %}

{% block body %}

    {% if app.user.getCategoryService().getId() is defined %}
               {% set id_catserv = app.user.getCategoryService().getId() %}
    {% else %} {% set id_catserv = '0' %}
    {% endif %}
    {% if id_catserv == 1 or id_catserv == 2 or id_catserv == 3 %}
        {% set is_hidden = '' %}
    {% else %}
        {% set is_hidden = 'hidden' %}
    {% endif %}

    <ol class="breadcrumb">
        <li><a href="{{ path('user_index') }}">{{ 'home'|trans }}</a></li>
        <li class="active">{{ 'edit.order.workshop'|trans }}</li>

        {% if (is_granted('ROLE_ADMIN') or (id_catserv == 1 or id_catserv == 2 or id_catserv == 3)) and token is defined and token != null and token != '' %}
            <p class="pull-right">Token: <b>{{token}}</b></p>
        {% endif %}
    </ol>

    <h1>
        {{ 'edit.order.workshop'|trans }} <b>{{ workshop.partner.codePartner }}, {{ workshop.codeWorkshop }}</b>
    </h1>
        <a href="{{ path('doPdfWorkshop', { id: workshop.id }) }}" type="button" id="btn_pdf" name="btn_pdf" class='pull-right'>
            <img class="img_icon_left" src="{{ asset('bundles/util/images/icon/export_pdf.png') }}">
            <label >{{ 'print'|trans }} </label>
        </a>

    {{ form_start(form, {'action': '#'}) }}

        <div class="col-xs-12 col-md-12 form-group">
            <input type="hidden" id="exist_cif" value="{{ 'workshop.cif_exist'|trans }} ">
            <div class="error_cif"></div>
            {% for flashMessage in app.session.flashbag.get('info' ) %}
                {{ flashMessage }}
            {% endfor %}

            {% for flashMessage in app.session.flashbag.get('error') %}
                <p style="color:red">{{ flashMessage }}</p>
            {% endfor %}
        </div>
        <div class="col-xs-10 col-md-10 form-group fl">
            <div class="col-xs-3 col-md-3">
                <label>{{ 'name'|trans }}</label>
                {{ form_widget(form.name, { 'attr': {'class': 'form-control',
                                                     'placeholder': 'name' } }) }}
            </div>
            {% if is_granted('ROLE_SUPER_AD') %}
                <div class="col-xs-3 col-md-3 form-group">
                    <label for="adservice_partnerbundle_shoptype">{{ 'partner'|trans }} * </label>
                    {{ form_widget(form.partner, { 'attr': {'class': 'form-control' } }) }}
                </div>
            {% else %} {{ form_widget(form.partner, { 'attr': {'hidden': 'hidden' } }) }}
            {% endif %}

            {% if id_catserv != 3 %}
                <div class="col-xs-3 col-md-3">
                    <input type="hidden" id="id_partner" value="{{ id_partner }}">
                    <input type="hidden" id="id_shop" value="{{ id_shop }}">
                    <label>{{ 'shop'|trans }} </label> {{ form_widget(form.shop, { 'attr': {'class': 'form-control', 'required': 'false'} }) }}
                </div>
            {% endif %}

            <div class="col-xs-3 col-md-3">
                <label>{{ 'typology'|trans }} *</label> {{ form_widget(form.typology, { 'attr': {'class': 'form-control'} }) }}
            </div>
            <div class="col-xs-3 col-md-3">
                <label>{{ 'cif'|trans }} * </label>
                {{ form_widget(form.cif, { 'attr': {'class': 'form-control',
                                                     'placeholder': 'cif' ,
                                                     'required':'required' } }) }}
            </div>
        </div>
        <div class="col-xs-2 col-md-2 form-group fr">
            {% if id_catserv != 3 %}
            <div class="w65 fl mb15 {{is_hidden}}">
                <label>{{ 'ad_service_plus'|trans }}</label>
            </div>
            <div class="w35 fr mb15 {{is_hidden}}">
                {{ form_widget(form.ad_service_plus) }}
            </div>
            {% endif %}
            <div class="w65 fl mb15">
                <label>{{ 'test'|trans }}</label>
            </div>
            <div class="w35 fr mb15">
                {{ form_widget(form.test) }}
            </div>
            <div class="w65 fl ">
                <label for="workshopOrder_newOrder_haschecks">{{ 'haschecks'|trans }}</label>
            </div>
            <div class="w35 fr ">
                {{ form_widget(form.haschecks) }}
            </div>
            <div class="w65 fl mb15">
                <label for="workshopOrder_newOrder_numchecks">{{ 'numchecks'|trans }}</label>
            </div>
            <div class="w35 fr mb15">
                {{ form_widget(form.numchecks, { 'attr': {'class': 'form-control', 'min': '0' , 'max': '5', 'placeholder': 'max_num_checks' }}) }}
            </div>
            {% if id_catserv != 3 %}
            <div class="w65 fl {{is_hidden}}">
                <label for="workshopOrder_newOrder_infotech">{{ 'infotech'|trans }}</label>
            </div>
            <div class="w35 fr {{is_hidden}}">
                {{ form_widget(form.infotech) }}
            </div>
            {% endif %}
        </div>
        <div class="col-xs-10 col-md-10 form-group fl">
            <div class="col-xs-3 col-md-3">
                <label>{{ 'code_workshop'|trans }}</label> {{ form_widget(form.code_workshop,   { 'attr': {'class': 'form-control', 'min': '1', 'required':'required' } }) }}
                {# <input type="hidden" id="code" name="code" value="{{ code }}"> #}
            </div>
            <div class="col-xs-3 col-md-3">
                <label>{{ 'internal_code'|trans }}</label>
                {{ form_widget(form.internal_code, { 'attr': {'class': 'form-control', 'placeholder': 'internal_code' } }) }}
            </div>
            <div class="col-xs-3 col-md-3" {% if id_catserv == 3 %} hidden {% endif %}>
                <label>{{ 'commercial_code'|trans }}</label>
                {{ form_widget(form.commercial_code, { 'attr': {'class': 'form-control', 'placeholder': 'commercial_code' } }) }}
            </div>
            <div class="col-xs-3 col-md-3">
                <label>{{ 'diagnosis_machines'|trans }} *</label> {{ form_widget(form.diagnosis_machines, { 'attr': {'class': 'form-control'} }) }}
            </div>
            {% if is_granted('ROLE_ADMIN') %}
                <div class="col-xs-3 col-md-3">
                    <label>{{ 'category_service'|trans }} *</label> <input type="text" id="category_service" class="form-control" value="{{ workshop.categoryService }}" disabled="disabled">
                </div>
            {% endif %}
        </div>
        <div class="col-xs-12 col-md-12 form-group">
            {% for flashMessage in app.session.flashbag.get('info' ) %}
                {{ flashMessage }}
            {% endfor %}
            {% for flashMessage in app.session.flashbag.get('error') %}
                <p style="color:red">{{ flashMessage }}</p>
            {% endfor %}
        </div>
        <legend>{{ 'contact'|trans }}</legend>

        <div class="col-xs-12 col-md-12 form-group">
        <div class="col-xs-2 col-md-2 form-group">
                <label>{{ 'contact'|trans }}</label> {{ form_widget(form.contact, { 'attr': {'class': 'form-control', 'placeholder': 'contact' } }) }}
        </div>
        {% include 'UtilBundle:Default:contact_fields.html.twig' %}

        {{ form_rest(form) }}

        <div class="col-xs-12 col-md-12 form-group">
            <button class="btn btn-primary pull-right" id="btn_save" type="submit">{{ 'btn.edit'|trans }}</button>
        </div>
    {{ form_end(form) }}

{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('bundles/order/js/order_workshop.js') }}"></script>
    <script src="{{ asset('bundles/order/js/order.js') }}"></script>
{% endblock %}