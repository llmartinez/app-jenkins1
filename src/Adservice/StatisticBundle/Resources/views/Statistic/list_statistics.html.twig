{% extends '::layout.html.twig' %}

{% block body %}
    <ol class="breadcrumb">
        <li><a href="{{ path('user_index') }}">{% trans %} home {% endtrans %}</a></li>
        <li class="active"> {% trans %} menu.list_statistics {% endtrans %} </li>
    </ol>

<div class="colIzq">

    <legend>{% trans %} tickets {% endtrans %}</legend>

        <div class="col-xs-6 col-md-6 form-group"> <label> {% trans %} date.start {% endtrans %} </label><input id="flt_tck_from" type="date"
            {% if date_from != 'none' %} value="{{ date_from | date ('Y-m-d')}}" {% endif %} ></div>
        <div class="col-xs-6 col-md-6 form-group"> <label> {% trans %} date.end {% endtrans %} </label><input id="flt_tck_to" type="date"
            {% if date_to != 'none'   %} value="{{ date_to   | date ('Y-m-d')}}" {% endif %} ></div>
        {% if is_granted('ROLE_SUPER_ADMIN') %}
        <div class="col-xs-6 col-md-6 form-group"> <label> {% trans %} country {% endtrans %}</label><select id="flt_tck_country" class='form-control'>
                                                                                    <option value="none">{% trans %} all {% endtrans %}</option>
                                                                                {% for country in countries %}
                                                                                    <option value="{{ country.id }}">{{ country }}</option>
                                                                                {% endfor %}
                                                                          </select></div>
        {% endif %}
        <div class="col-xs-6 col-md-6 form-group"> <label> {% trans %} partner {% endtrans %}</label><select id="flt_tck_partner" class='form-control'>
                                                                                    <option value="none">{% trans %} all {% endtrans %}</option>
                                                                                {% for partner in partners %}
                                                                                    <option value="{{ partner.id }}">{{ partner }}</option>
                                                                                {% endfor %}
                                                                          </select></div>
        <div class="col-xs-6 col-md-6 form-group"> <label> {% trans %} status {% endtrans %}</label><select id="flt_tck_status" class='form-control'>
                                                                                                <option value="all"    >{% trans %} all    {% endtrans %}</option>
                                                                                                <option value="open"   >{% trans %} open   {% endtrans %}</option>
                                                                                                <option value="closed" >{% trans %} closed {% endtrans %}</option>
                                                                                             </select></div>
        <div class="col-xs-12 col-md-12 form-group">
            <button class="btn btn-primary btn100" id="btn_search_ticket">{% trans %} ticket.search {% endtrans %}</button>
        </div>


    <legend>{% trans %} workshops {% endtrans %}</legend>

        <div class="col-xs-6 col-md-6 form-group"> <label> {% trans %} date.start {% endtrans %} </label><input id="flt_wks_from" type="date"></div>
        <div class="col-xs-6 col-md-6 form-group"> <label> {% trans %} date.end {% endtrans %} </label><input id="flt_wks_to" type="date"></div>
        {% if is_granted('ROLE_SUPER_ADMIN') %}
        <div class="col-xs-6 col-md-6 form-group"> <label> {% trans %} country {% endtrans %}</label><select id="flt_wks_country" class='form-control'>
                                                                                        <option value="none">{% trans %} all {% endtrans %}</option>
                                                                                    {% for country in countries %}
                                                                                        <option value="{{ country.id }}">{{ country }}</option>
                                                                                {% endfor %}
                                                                          </select></div>
        {% endif %}
        <div class="col-xs-6 col-md-6 form-group"> <label> {% trans %} partner {% endtrans %}</label><select id="flt_wks_partner" class='form-control'>
                                                                                        <option value="none">{% trans %} all {% endtrans %}</option>
                                                                                    {% for partner in partners %}
                                                                                        <option value="{{ partner.id }}">{{ partner }}</option>
                                                                                {% endfor %}
                                                                          </select></div>
        <div class="col-xs-6 col-md-6 form-group"> <label> {% trans %} status {% endtrans %}</label><select id="flt_wks_status" class='form-control'>
                                                                                            <option value="all"     >{% trans %} all      {% endtrans %}</option>
                                                                                            <option value="active"  >{% trans %} active   {% endtrans %}</option>
                                                                                            <option value="deactive">{% trans %} deactive {% endtrans %}</option>
                                                                                            {# <option value="noticket">Without Tickets</option> #}
                                                                                         </select></div>
        <div class="col-xs-12 col-md-12 form-group">
            <button class="btn btn-primary btn100" id="btn_search_workshop">{% trans %} workshop.search {% endtrans %}</button>
        </div>
</div>

<div class="colDer pad-left">

    {% if statistic.results is defined %}

        {% if type == 'ticket' %}
        <legend> {% trans %} statistic.tickets {% endtrans %}
            {% if is_granted('ROLE_SUPER_ADMIN')  %} {% trans %} statistic.from_adservice {% endtrans %}
            {% else %}                               {% trans %} statistic.from_country   {% endtrans %}
        {% endif %}
            <span id="doExcel_ticket" class="glyphicon glyphicon-download-alt" title="Excel download" >
        </legend>

            <table class="table table-hover table-list-search">
                <thead>
                    <tr>
                        <th> #           </th>
                        <th>{% trans %} date               {% endtrans %}</th>
                        <th>{% trans %} car                {% endtrans %}</th>
                        <th>{% trans %} ticket.assigned_to {% endtrans %}</th>
                        <th>{% trans %} description        {% endtrans %}</th>
                        <th>{% trans %} status             {% endtrans %}</th>
                    </tr>
                </thead>
                <tbody id="ticketBody">
                    {% for ticket in statistic.results %}
                        <tr id="ticketRow">
                            <td id="id_ticket">{{ ticket.id         }}</td>
                            <td>{{ ticket.createdAt | date("d/m/Y") }}</td>
                            <td>{{ ticket.car                       }}</td>
                            <td>{{ ticket.assignedTo                }}</td>
                            <td>{{ ticket.description               }}</td>
                            <td>{{ ticket.status                    }}</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        <div class="col-xs-12 col-md-12 form-group">{% include 'UtilBundle:Pagination:pagination_statistic_ticket.html.twig' %}</div>

        {% elseif type == 'workshop' %}
        <legend> {% trans %} statistic.workshops {% endtrans %}
            {% if is_granted('ROLE_SUPER_ADMIN')  %} {% trans %} statistic.from_adservice {% endtrans %}
            {% else %}                               {% trans %} statistic.from_country   {% endtrans %}
        {% endif %}
            <span id="doExcel_workshop" class="glyphicon glyphicon-download-alt" title="Excel download">
        </legend>

            <table class="table table-hover table-list-search">
                <thead>
                    <tr>
                        <th>{% trans %} code     {% endtrans %}</th>
                        <th>{% trans %} workshop {% endtrans %}</th>
                        <th>{% trans %} partner  {% endtrans %}</th>
                        <th>{% trans %} email    {% endtrans %}</th>
                        <th>{% trans %} tel      {% endtrans %}</th>
                    </tr>
                </thead>
                <tbody>
                        {% for workshop in statistic.results %}
                    <tr>
                        <td>{{ workshop.partner.codePartner }}, {{ workshop.codeWorkshop }}</td>
                        <td>{{ workshop.name }} {% if workshop.active == false %}<span class="label label-danger">{% trans %} inactive {% endtrans %}</span>{% endif %}</td>
                        <td>{{ workshop.partner}}</td>
                        <td>{{ workshop.email1 }}</td>
                        <td>{{ workshop.phoneNumber1 }}</td>
                    </tr>
                        {% endfor %}
                </tbody>
            </table>
        <div class="col-xs-12 col-md-12 form-group">{% include 'UtilBundle:Pagination:pagination_statistic_workshop.html.twig' %}</div>

        {% else %}
        <legend> {% trans %} statistic.general {% endtrans %}
            {% if is_granted('ROLE_SUPER_ADMIN')  %} {% trans %} statistic.from_adservice {% endtrans %}
            {% else %}                               {% trans %} statistic.from_country   {% endtrans %}
        {% endif %} </legend>
            <div class="col-xs-8 col-md-8 form-group"> <label>{% trans %} statistic.num_users          {% endtrans %}</label></div>
            <div class="col-xs-4 col-md-4 form-group">                 {{ statistic.getNumUsers         }}            </div>
            <div class="col-xs-8 col-md-8 form-group"> <label>{% trans %} statistic.num_partners       {% endtrans %}</label></div>
            <div class="col-xs-4 col-md-4 form-group">                 {{ statistic.getNumPartners      }}            </div>
            <div class="col-xs-8 col-md-8 form-group"> <label>{% trans %} statistic.num_shops          {% endtrans %}</label></div>
            <div class="col-xs-4 col-md-4 form-group">                 {{ statistic.getNumShops         }}            </div>
            <div class="col-xs-8 col-md-8 form-group"> <label>{% trans %} statistic.num_workshops      {% endtrans %}</label></div>
            <div class="col-xs-4 col-md-4 form-group">                 {{ statistic.getNumWorkshops     }}            </div>
            <div class="col-xs-8 col-md-8 form-group"> <label>{% trans %} statistic.num_tickets        {% endtrans %}</label></div>
            <div class="col-xs-4 col-md-4 form-group">                 {{ statistic.getNumTickets       }}            </div>
            <div class="col-xs-8 col-md-8 form-group"> <label>{% trans %} statistic.num_tickets.open   {% endtrans %}</label></div>
            <div class="col-xs-4 col-md-4 form-group">                 {{ statistic.getNumOpenTickets   }}            </div>
            <div class="col-xs-8 col-md-8 form-group"> <label>{% trans %} statistic.num_tickets.closed {% endtrans %}</label></div>
            <div class="col-xs-4 col-md-4 form-group">                 {{ statistic.getNumClosedTickets }}            </div>
        {% endif %}
    {% endif %}

</div>

    {% include 'UtilBundle:jquery_twig:statistics_jquery.html.twig' %}
{% endblock %}